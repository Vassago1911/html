<!DOCTYPE html><html><head></head><body></body>
<script type="text/javascript">
vbx = 4096;layer_count = 5// -> svg_canvas.js</script>
<script src="svg_canvas.js"></script>
<link href="std.css" rel="stylesheet"/><script src="colours.js"></script>
<script type="text/javascript">
    class Guard {
        show_svg_visual () {
            if ( [...document.getElementsByClassName(this.name)].length == 0 ) {
                draw_classy_circle(x,y,16,this.name)
                draw_classy_circle(x,y,10,this.name)
            }
        }

        constructor ( x, y ) {
            this.x = x;
            this.y = y;
            this.name = `${Date.now()}`.substring(7)
            this.show_svg_visual()
        }
    }

    class GuardNet {
        constructor () {
            this.guards = []
            this.net = []
        }

        add_edge ( i, j ) {
            if ( this.guards[i].name >= this.guards[j].name ) {
                tmp = i; i=j; j=tmp;
            }
            g1 = this.guards[i]
            g2 = this.guards[j]
            e = g1.name+','+g2.name
            if ( !( e in this.net )) {
                this.net = this.net.concat([e])
                
            }
        }

        add_guard( g ) {


            this.guards = this.guards.concat([g])
        }
    }

    gnet = new GuardNet()

    function add_node(evt) {
        tmp = get_svg_xy_from_event(evt)
        x = tmp[0]
        y = tmp[1]
        g = new Guard(x,y)
        gnet.add_guard(g)
        nodes = nodes.concat([[x,y]]);
        nodes = nodes.sort( (a,b) => a[0] - b[0] )
        dist = gen_distance_matrix(nodes)
        //gen_edges()
    }
    //todo: distance calc'd => calc nneighbours
    nneighbours = []
    function gen_distance_matrix(nodes) {
        dist = []
        for ( let i = 0; i < nodes.length; i++ ) {
            dist[i] = []
        }
        for ( let i = 0; i < nodes.length; i++ ) {
            for ( let j = 0; j < nodes.length; j++) {
                d = parseInt(Math.sqrt( (nodes[i][0]-nodes[j][0])**2+(nodes[i][1]-nodes[j][1])**2 ))
                dist[j][i] = d
                dist[i][j] = d
            }
        }
        return dist
    }
    function gen_edges() {
        edge_ixs = [];
        _tmp_v_degree = [];
        for ( let i = 0; i < nodes.length; i++ ) {
            _tmp_v_degree[i]=0
        }
        for ( let i = 0; i < nodes.length; i++ ) {
            for ( let j = i+1; j < nodes.length; j++ ) {
                
            }
        }
    }
    nodes = []
    model = {}
    svg = document.getElementById("total_svg1")
    bg = document.getElementById(`layer_${0}`)
    fg = document.getElementById(`layer_${layer_count - 1}`)
    svg.addEventListener("click",add_node)
</script>
</html>